{% extends "base.html" %}
{% load i18n %}

{% block title %}Write email{% endblock %}

{% block pagetitle %}Write new email{% endblock %}

{% block content %}
<form action="/messages/email/write/" method="POST">
{% if emailform.errors %}
<div class="error">
Please correct the following field(s):<br>
{% for error in emailform.errors %}
- {{error}}<br>
{% endfor %}
</div>
{% endif %}
<table>
  <tr>
    <td valign="top"><strong>To:</strong></td>
    <td>
      <table border="0" width="100%" cellpadding="0" cellspacing="0">
        <tr>
{% if request.user.is_superuser %}
          <td style="vertical-align: top" width="30"><input name="type" type="radio" value="1" id="type1" disabled="disabled" /></td>
          <td style="vertical-align: top"><label for="type1"><span style="text-decoration: line-through">All members who have opted to receive email from the following chapters</span></label></td>
{% else %}
          <td style="vertical-align: top" width="30"><input name="type" type="radio" value="1" id="type1" checked="checked" /></td>
          <td style="vertical-align: top"><label for="type1">All members of {{ request.user.chapter }} who have opted to receive email</label></td>
{% endif %}
        </tr>
{% if request.user.is_superuser %}
      </table>
      <table border="0" width="100%" cellpadding="0" cellspacing="0" id="form_table_chapters">
        <tr>
          <td style="vertical-align: top" width="30">&nbsp;</td>
          <td style="vertical-align: top">{{ emailform.chapters }}</td>
        </tr>
      </table>
      <table border="0" width="100%" cellpadding="0" cellspacing="0">
{% endif %}
        <tr>
{% if request.user.is_superuser %}
          <td style="vertical-align: top" width="30"><input name="type" type="radio" value="2" id="type2" checked="checked" /></td>
          <td style="vertical-align: top"><label for="type2">Executive committee members of the following chapters</label></td>
{% else %}
          <td style="vertical-align: top" width="30"><input name="type" type="radio" value="2" id="type2" /></td>
          <td style="vertical-align: top"><label for="type2">Executive committee members of {{ request.user.chapter }}</label></td>
{% endif %}
        </tr>
{% if request.user.is_superuser %}
      </table>
      <table border="0" width="100%" cellpadding="0" cellspacing="0" id="form_table_exec">
        <tr>
          <td style="vertical-align: top" width="30">&nbsp;</td>
          <td style="vertical-align: top">{{ emailform.chapters_exec }}</td>
        </tr>
      </table>
      <table border="0" width="100%" cellpadding="0" cellspacing="0">
{% endif %}
        <tr>
          <td style="vertical-align: top" width="30"><input name="type" type="radio" value="5" id="type5" /></td>
          <td style="vertical-align: top"><label for="type5">To a member list</label></td>
        </tr>
      </table>
      <table border="0" width="100%" cellpadding="0" cellspacing="0" id="form_table_lists">
        <tr>
          <td style="vertical-align: top" width="30">&nbsp;</td>
          <td style="vertical-align: top"><b>N.B.</b> Message will only be sent to list members who have opted to receive email</td>
        </tr>
        <tr>
          <td style="vertical-align: top" width="30">&nbsp;</td>
          <td style="vertical-align: top">{{ emailform.list }}</td>
        </tr>
      </table>
      <table border="0" width="100%" cellpadding="0" cellspacing="0">
        <tr>
          <td style="vertical-align: top" width="30"><input name="type" type="radio" value="3" id="type3" /></td>
          <td style="vertical-align: top"><label for="type3">Select individual members</label></td>
        </tr>
      </table>
      <table border="0" width="100%" cellpadding="0" cellspacing="0" id="form_table_recipients">
        <tr>
          <td style="vertical-align: top" width="30">&nbsp;</td>
          <td style="vertical-align: top"><b>N.B.</b> Only members who have opted to receive email are shown</td>
        </tr>
        <tr>
          <td style="vertical-align: top" width="30">&nbsp;</td>
          <td style="vertical-align: top">{{ emailform.recipients }}</td>
        </tr>
      </table>
{% if request.user.is_superuser %}
      <table border="0" width="100%" cellpadding="0" cellspacing="0">
        <tr>
          <td style="vertical-align: top" width="30"><input name="type" type="radio" value="4" id="type4" /></td>
          <td style="vertical-align: top"><label for="type4">Send newsletter</label></td>
        </tr>
      </table>
      <table border="0" width="100%" cellpadding="0" cellspacing="0" id="form_table_newsletter">
        <tr>
          <td style="vertical-align: top" width="30">&nbsp;</td>
          <td style="vertical-align: top">{{ emailform.newsletters }}</td>
        </tr>
      </table>
{% endif %}
    </td>
  </tr>
  <tr>
    <td valign="top"><strong>From:</strong></td>
    <td><span id="from_normal">{{ emailform.from_type }}</span><span id="from_newsletter" style="display: none">From address set according to newsletter options</span></td>
  </tr>
  <tr>
    <td valign="top"><strong>Subject:</strong></td>
    <td>{{ emailform.subject }}</td>
  </tr>
  <tr>
    <td valign="top"><strong>Message:</strong></td>
    <td>{{ emailform.body }}</td>
  </tr>
  <tr>
    <td valign="top"><strong>HTML:</strong></td>
    <td><span id="html_normal">{{ emailform.html }} Treat this message as HTML (note that line breaks will <b>not</b> be automatically converted to &lt;br&gt;)</span>
    <span id="html_newsletter" style="display: none">HTML automatically <strong>on</strong> for newsletter</span></td>
  </tr>
</table>
<div id="newsletter_warning" style="padding: 7px; margin: 7px; background-color: #CC0000; color: #FFFFFF; display: none">
<strong>This newsletter will be sent to hundreds of people. If this message is showing, then the option you have selected is the real thing and NOT a test. Please ensure:</strong>
<ul>
  <li>All relevant procedures for this newsletter have been complied with</li>
  <li>An up-to-date web version has been uploaded for people who click "view it online"</li>
  <li>{% trans "{{email_id}}" %} has been inserted into the email here, but not the "view it online" version</li>
</ul>
</div>
<input type="submit" value="Send Email!" />
</form>
{% endblock %}
